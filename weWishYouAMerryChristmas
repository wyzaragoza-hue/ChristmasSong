/*
  We Wish You a Merry Christmas
  Robson Couto, 2019
*/

#include <Wire.h>
#include <LiquidCrystal_I2C.h>

// LCD address 0x27, 16 columns, 2 rows
LiquidCrystal_I2C lcd(0x27, 16, 2);

#define BUZZER_PIN 11

#define REST 0
#define NOTE_C5 523
#define NOTE_D5 587
#define NOTE_E5 659
#define NOTE_F5 698
#define NOTE_G5 784
#define NOTE_A5 880
#define NOTE_AS5 932
#define NOTE_C6 1047

int tempo = 140;

// Melody: note, duration
int melody[] = {
  NOTE_C5,4,
  NOTE_F5,4, NOTE_F5,8, NOTE_G5,8, NOTE_F5,8, NOTE_E5,8,
  NOTE_D5,4, NOTE_D5,4, NOTE_D5,4,
  NOTE_G5,4, NOTE_G5,8, NOTE_A5,8, NOTE_G5,8, NOTE_F5,8,
  NOTE_E5,4, NOTE_C5,4, NOTE_C5,4,
  NOTE_A5,4, NOTE_A5,8, NOTE_AS5,8, NOTE_A5,8, NOTE_G5,8,
  NOTE_F5,4, NOTE_D5,4, NOTE_C5,2,
  REST,4
};

int notes = sizeof(melody) / sizeof(melody[0]) / 2;
int wholenote = (60000 * 4) / tempo;

void setup() {
  pinMode(BUZZER_PIN, OUTPUT);

  Wire.begin();

  // LCD init (works with most libraries)
  lcd.init();
  lcd.backlight();

  lcd.setCursor(0, 0);
  lcd.print("We Wish You a");
  lcd.setCursor(0, 1);
  lcd.print("Merry Xmas!");

  for (int i = 0; i < notes * 2; i += 2) {
    int note = melody[i];
    int divider = melody[i + 1];

    int duration = wholenote / divider;

    if (note != REST) {
      tone(BUZZER_PIN, note, duration * 0.9);
    }

    delay(duration);
    noTone(BUZZER_PIN);
  }
}

void loop() {
  // Play once only
}
